import{c as Le,g as Ae,m as d,r as P,j as t,b as $,u as De,z as X,C as Te,M as Ie}from"./index-Dza2ow_d.js";import{r as ee,t as Q,g as ie,f as Ue}from"./index-CipiYhTN.js";import{C as Me}from"./calendar-CDwTpDyp.js";import{T as _e}from"./trending-up-QOAHLxeJ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=Le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function oe(n){ee(1,arguments);var e=Q(n);return e.setHours(0,0,0,0),e}var ze=864e5;function We(n,e){ee(2,arguments);var r=oe(n),s=oe(e),a=r.getTime()-ie(r),i=s.getTime()-ie(s);return Math.round((a-i)/ze)}function ce(n,e){var r=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function Ye(n,e){ee(2,arguments);var r=Q(n),s=Q(e),a=ce(r,s),i=Math.abs(We(r,s));r.setDate(r.getDate()-a*i);var c=+(ce(r,s)===-a),l=a*(i-c);return l===0?0:l}var xe="clover",Fe=function(e){return e===3?"v3":e},ve="https://js.stripe.com",Be="".concat(ve,"/").concat(xe,"/stripe.js"),qe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Ke=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var Ve=function(e){return qe.test(e)||Ke.test(e)},Ge=function(){for(var e=document.querySelectorAll('script[src^="'.concat(ve,'"]')),r=0;r<e.length;r++){var s=e[r];if(Ve(s.src))return s}return null},le=function(e){var r="",s=document.createElement("script");s.src="".concat(Be).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(s),s},He=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.0.0",startTime:r})},M=null,q=null,K=null,Je=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},Xe=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},Qe=function(e){return M!==null?M:(M=new Promise(function(r,s){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var a=Ge();if(!(a&&e)){if(!a)a=le(e);else if(a&&K!==null&&q!==null){var i;a.removeEventListener("load",K),a.removeEventListener("error",q),(i=a.parentNode)===null||i===void 0||i.removeChild(a),a=le(e)}}K=Xe(r,s),q=Je(s),a.addEventListener("load",K),a.addEventListener("error",q)}catch(c){s(c);return}}),M.catch(function(r){return M=null,Promise.reject(r)}))},Ze=function(e,r,s){if(e===null)return null;var a=r[0],i=a.match(/^pk_test/),c=Fe(e.version),l=xe;i&&c!==l&&console.warn("Stripe.js@".concat(c," was loaded on the page, but @stripe/stripe-js@").concat("8.0.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,r);return He(o,s),o},_,ge=!1,ye=function(){return _||(_=Qe(null).catch(function(e){return _=null,Promise.reject(e)}),_)};Promise.resolve().then(function(){return ye()}).catch(function(n){ge||console.warn(n)});var et=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];ge=!0;var a=Date.now();return ye().then(function(i){return Ze(i,r,a)})},be={exports:{}},tt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",rt=tt,nt=rt;function je(){}function Ne(){}Ne.resetWarningCache=je;var st=function(){function n(s,a,i,c,l,o){if(o!==nt){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}n.isRequired=n;function e(){return n}var r={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ne,resetWarningCache:je};return r.PropTypes=r,r};be.exports=st();var at=be.exports;const m=Ae(at);function de(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function ue(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?de(Object(r),!0).forEach(function(s){Ce(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function V(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?V=function(e){return typeof e}:V=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(n)}function Ce(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function it(n,e){if(n==null)return{};var r={},s=Object.keys(n),a,i;for(i=0;i<s.length;i++)a=s[i],!(e.indexOf(a)>=0)&&(r[a]=n[a]);return r}function ot(n,e){if(n==null)return{};var r=it(n,e),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(a=0;a<i.length;a++)s=i[a],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(n,s)&&(r[s]=n[s])}return r}function Se(n,e){return ct(n)||lt(n,e)||dt(n,e)||ut()}function ct(n){if(Array.isArray(n))return n}function lt(n,e){var r=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(r!=null){var s=[],a=!0,i=!1,c,l;try{for(r=r.call(n);!(a=(c=r.next()).done)&&(s.push(c.value),!(e&&s.length===e));a=!0);}catch(o){i=!0,l=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return s}}function dt(n,e){if(n){if(typeof n=="string")return me(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return me(n,e)}}function me(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=n[r];return s}function ut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=function(e,r,s){var a=!!s,i=d.useRef(s);d.useEffect(function(){i.current=s},[s]),d.useEffect(function(){if(!a||!e)return function(){};var c=function(){i.current&&i.current.apply(i,arguments)};return e.on(r,c),function(){e.off(r,c)}},[a,r,e,i])},Z=function(e){var r=d.useRef(e);return d.useEffect(function(){r.current=e},[e]),r.current},U=function(e){return e!==null&&V(e)==="object"},mt=function(e){return U(e)&&typeof e.then=="function"},pt=function(e){return U(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},pe="[object Object]",ft=function n(e,r){if(!U(e)||!U(r))return e===r;var s=Array.isArray(e),a=Array.isArray(r);if(s!==a)return!1;var i=Object.prototype.toString.call(e)===pe,c=Object.prototype.toString.call(r)===pe;if(i!==c)return!1;if(!i&&!s)return e===r;var l=Object.keys(e),o=Object.keys(r);if(l.length!==o.length)return!1;for(var v={},x=0;x<l.length;x+=1)v[l[x]]=!0;for(var g=0;g<o.length;g+=1)v[o[g]]=!0;var p=Object.keys(v);if(p.length!==l.length)return!1;var f=e,k=r,S=function(w){return n(f[w],k[w])};return p.every(S)},ht=function(e,r,s){return U(e)?Object.keys(e).reduce(function(a,i){var c=!U(r)||!ft(e[i],r[i]);return s.includes(i)?(c&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),a):c?ue(ue({},a||{}),{},Ce({},i,e[i])):a},null):null},we="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",fe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:we;if(e===null||pt(e))return e;throw new Error(r)},xt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:we;if(mt(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(a){return fe(a,r)})};var s=fe(e,r);return s===null?{tag:"empty"}:{tag:"sync",stripe:s}},vt=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.0.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.0.0",url:"https://stripe.com/docs/stripe-js/react"}))},Ee=d.createContext(null);Ee.displayName="ElementsContext";var gt=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e};m.any,m.object;m.func.isRequired;var ke=d.createContext(null);ke.displayName="CheckoutContext";m.any,m.shape({clientSecret:m.oneOfType([m.string,m.instanceOf(Promise)]).isRequired,elementsOptions:m.object}).isRequired;var he=function(e){var r=d.useContext(ke),s=d.useContext(Ee);if(r){if(s)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return gt(s,e)},yt=["mode"],bt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},C=function(e,r){var s="".concat(bt(e),"Element"),a=function(o){var v=o.id,x=o.className,g=o.options,p=g===void 0?{}:g,f=o.onBlur,k=o.onFocus,S=o.onReady,h=o.onChange,w=o.onEscape,D=o.onClick,E=o.onLoadError,u=o.onLoaderStart,R=o.onNetworksChange,T=o.onConfirm,z=o.onCancel,W=o.onShippingAddressChange,I=o.onShippingRateChange,Y=o.onSavedPaymentMethodRemove,G=o.onSavedPaymentMethodUpdate,F=he("mounts <".concat(s,">")),B="elements"in F?F.elements:null,A="checkoutState"in F?F.checkoutState:null,O=(A==null?void 0:A.type)==="success"||(A==null?void 0:A.type)==="loading"?A.sdk:null,Re=d.useState(null),re=Se(Re,2),y=re[0],Oe=re[1],L=d.useRef(null),H=d.useRef(null);j(y,"blur",f),j(y,"focus",k),j(y,"escape",w),j(y,"click",D),j(y,"loaderror",E),j(y,"loaderstart",u),j(y,"networkschange",R),j(y,"confirm",T),j(y,"cancel",z),j(y,"shippingaddresschange",W),j(y,"shippingratechange",I),j(y,"savedpaymentmethodremove",Y),j(y,"savedpaymentmethodupdate",G),j(y,"change",h);var J;S&&(e==="expressCheckout"?J=S:J=function(){S(y)}),j(y,"ready",J),d.useLayoutEffect(function(){if(L.current===null&&H.current!==null&&(B||O)){var b=null;if(O)switch(e){case"payment":b=O.createPaymentElement(p);break;case"address":if("mode"in p){var se=p.mode,ae=ot(p,yt);if(se==="shipping")b=O.createShippingAddressElement(ae);else if(se==="billing")b=O.createBillingAddressElement(ae);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":b=O.createExpressCheckoutElement(p);break;case"currencySelector":b=O.createCurrencySelectorElement();break;case"taxId":b=O.createTaxIdElement(p);break;default:throw new Error("Invalid Element type ".concat(s,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else B&&(b=B.create(e,p));L.current=b,Oe(b),b&&b.mount(H.current)}},[B,O,p]);var ne=Z(p);return d.useEffect(function(){if(L.current){var b=ht(p,ne,["paymentRequest"]);b&&"update"in L.current&&L.current.update(b)}},[p,ne]),d.useLayoutEffect(function(){return function(){if(L.current&&typeof L.current.destroy=="function")try{L.current.destroy(),L.current=null}catch{}}},[]),d.createElement("div",{id:v,className:x,ref:H})},i=function(o){he("mounts <".concat(s,">"));var v=o.id,x=o.className;return d.createElement("div",{id:v,className:x})},c=r?i:a;return c.propTypes={id:m.string,className:m.string,onChange:m.func,onBlur:m.func,onFocus:m.func,onReady:m.func,onEscape:m.func,onClick:m.func,onLoadError:m.func,onLoaderStart:m.func,onNetworksChange:m.func,onConfirm:m.func,onCancel:m.func,onShippingAddressChange:m.func,onShippingRateChange:m.func,onSavedPaymentMethodRemove:m.func,onSavedPaymentMethodUpdate:m.func,options:m.object},c.displayName=s,c.__elementType=e,c},N=typeof window>"u",te=d.createContext(null);te.displayName="EmbeddedCheckoutProviderContext";var Pe=function(){var e=d.useContext(te);if(!e)throw new Error("<EmbeddedCheckout> must be used within <EmbeddedCheckoutProvider>");return e},jt="Invalid prop `stripe` supplied to `EmbeddedCheckoutProvider`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Nt=function(e){var r=e.stripe,s=e.options,a=e.children,i=d.useMemo(function(){return xt(r,jt)},[r]),c=d.useRef(null),l=d.useRef(null),o=d.useState({embeddedCheckout:null}),v=Se(o,2),x=v[0],g=v[1];d.useEffect(function(){if(!(l.current||c.current)){var k=function(h){l.current||c.current||(l.current=h,c.current=l.current.initEmbeddedCheckout(s).then(function(w){g({embeddedCheckout:w})}))};i.tag==="async"&&!l.current&&(s.clientSecret||s.fetchClientSecret)?i.stripePromise.then(function(S){S&&k(S)}):i.tag==="sync"&&!l.current&&(s.clientSecret||s.fetchClientSecret)&&k(i.stripe)}},[i,s,x,l]),d.useEffect(function(){return function(){x.embeddedCheckout?(c.current=null,x.embeddedCheckout.destroy()):c.current&&c.current.then(function(){c.current=null,x.embeddedCheckout&&x.embeddedCheckout.destroy()})}},[x.embeddedCheckout]),d.useEffect(function(){vt(l)},[l]);var p=Z(r);d.useEffect(function(){p!==null&&p!==r&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the `stripe` prop after setting it.")},[p,r]);var f=Z(s);return d.useEffect(function(){if(f!=null){if(s==null){console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot unset options after setting them.");return}s.clientSecret===void 0&&s.fetchClientSecret===void 0&&console.warn("Invalid props passed to EmbeddedCheckoutProvider: You must provide one of either `options.fetchClientSecret` or `options.clientSecret`."),f.clientSecret!=null&&s.clientSecret!==f.clientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the client secret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),f.fetchClientSecret!=null&&s.fetchClientSecret!==f.fetchClientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change fetchClientSecret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),f.onComplete!=null&&s.onComplete!==f.onComplete&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onComplete option after setting it."),f.onShippingDetailsChange!=null&&s.onShippingDetailsChange!==f.onShippingDetailsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onShippingDetailsChange option after setting it."),f.onLineItemsChange!=null&&s.onLineItemsChange!==f.onLineItemsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onLineItemsChange option after setting it.")}},[f,s]),d.createElement(te.Provider,{value:x},a)},Ct=function(e){var r=e.id,s=e.className,a=Pe(),i=a.embeddedCheckout,c=d.useRef(!1),l=d.useRef(null);return d.useLayoutEffect(function(){return!c.current&&i&&l.current!==null&&(i.mount(l.current),c.current=!0),function(){if(c.current&&i)try{i.unmount(),c.current=!1}catch{}}},[i]),d.createElement("div",{ref:l,id:r,className:s})},St=function(e){var r=e.id,s=e.className;return Pe(),d.createElement("div",{id:r,className:s})},wt=N?St:Ct;C("auBankAccount",N);C("card",N);C("cardNumber",N);C("cardExpiry",N);C("cardCvc",N);C("iban",N);C("payment",N);C("expressCheckout",N);C("paymentRequestButton",N);C("linkAuthentication",N);C("address",N);C("shippingAddress",N);C("paymentMethodMessaging",N);C("taxId",N);const Et=et("pk_test_51SEsiCByyVatGfe2ax3fNq0hmKye71jdfdzHBvkNsIKAYuwqHc0mjKk0oUot9MrAvKzH5TzOdQ3oK9KYV0Lj1f8C007lyKhIgA"),kt=({plan:n,isOpen:e,onClose:r})=>{const[s,a]=P.useState(null),[i,c]=P.useState(!1),[l,o]=P.useState(null),v=async()=>{var g,p;try{return c(!0),o(null),(await $.post("/payment/pay",{planId:n.id,paymentGateway:"stripe"})).data.clientSecret}catch(f){const k=((p=(g=f.response)==null?void 0:g.data)==null?void 0:p.error)||"Failed to initialize payment";throw o(k),f}finally{c(!1)}},x=async()=>{const g=await v();a(g)};return e?t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"}),t.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Complete Payment"}),t.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s?t.jsx("div",{className:"p-6",children:t.jsx(Nt,{stripe:Et,options:{clientSecret:s},children:t.jsx(wt,{})})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Plan Details"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Plan Name:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:n.name})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Device Limit:"}),t.jsxs("span",{className:"font-semibold text-gray-900",children:[n.deviceLimit===-1?"Unlimited":n.deviceLimit," devices"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Duration:"}),t.jsxs("span",{className:"font-semibold text-gray-900",children:[n.durationDays," days"]})]}),t.jsx("div",{className:"border-t border-blue-300 pt-3 mt-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total Amount:"}),t.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["$",n.price.toFixed(2)]})]})})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[t.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"What's Included:"]}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Real-time GPS tracking"]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Historical route playback"]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Geofence alerts"]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Detailed reports and analytics"]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"24/7 customer support"]})]})]}),l&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:t.jsx("p",{className:"text-red-800 text-sm",children:l})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:r,className:"flex-1 btn-secondary py-3",disabled:i,children:"Cancel"}),t.jsx("button",{onClick:x,disabled:i,className:"flex-1 btn-primary py-3",children:i?t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("div",{className:"loading-spinner w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),t.jsx("span",{children:"Loading..."})]}):"Proceed to Payment"})]}),t.jsx("div",{className:"mt-4 text-center",children:t.jsx("p",{className:"text-xs text-gray-500",children:"Secured by Stripe. Your payment information is encrypted and secure."})})]})]})]})}):null};function At(){const{user:n,refreshUser:e}=De(),[r,s]=P.useState([]),[a,i]=P.useState(null),[c,l]=P.useState(!0),[o,v]=P.useState(null),[x,g]=P.useState(null),[p,f]=P.useState(!1);P.useEffect(()=>{k()},[]);const k=async()=>{try{const[u,R]=await Promise.all([$.get("/subscription/plans"),$.get("/subscription/usage")]);s(u.data.plans),i(R.data.usage)}catch(u){console.error("Error fetching dashboard data:",u),X.error("Failed to load dashboard data")}finally{l(!1)}},S=async(u,R="stripe")=>{var T,z;v(u);try{if((await $.post("/subscription/upgrade",{planId:u})).data.requiresPayment){if(R==="stripe"){const Y=r.find(G=>G.id===u);Y&&(g(Y),f(!0),v(null));return}const I=await $.post("/payment/pay",{planId:u,paymentGateway:R,useEmbedded:!1});I.data.checkoutUrl&&(window.location.href=I.data.checkoutUrl)}else X.success("Subscription upgraded successfully!"),await e(),k()}catch(W){const I=((z=(T=W.response)==null?void 0:T.data)==null?void 0:z.error)||"Failed to upgrade subscription";X.error(I)}finally{v(null)}};if(c)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"loading-spinner w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full"})});const h=n==null?void 0:n.subscription,w=h?Math.max(0,Ye(new Date(h.endDate),new Date)):0,D=w<=7&&w>0,E=w===0;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),t.jsx("p",{className:"text-gray-600",children:"Manage your GPS tracking subscription and devices"})]}),(D||E)&&t.jsx("div",{className:`card border-l-4 ${E?"border-l-error-500 bg-error-50":"border-l-warning-500 bg-warning-50"}`,children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx($e,{className:`w-5 h-5 mt-0.5 ${E?"text-error-600":"text-warning-600"}`}),t.jsxs("div",{children:[t.jsx("h3",{className:`font-medium ${E?"text-error-900":"text-warning-900"}`,children:E?"Subscription Expired":"Subscription Expiring Soon"}),t.jsx("p",{className:`text-sm ${E?"text-error-700":"text-warning-700"}`,children:E?"Your subscription has expired. Upgrade now to continue tracking your devices.":`Your subscription expires in ${w} day${w!==1?"s":""}. Consider upgrading to avoid service interruption.`})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:t.jsx(Te,{className:"w-5 h-5 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Current Plan"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(h==null?void 0:h.plan.name)||"No Plan"})]})]})}),t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:t.jsx(Ie,{className:"w-5 h-5 text-success-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Devices"}),t.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[(a==null?void 0:a.devicesUsed)||0," / ",(a==null?void 0:a.deviceLimit)||0]})]})]})}),t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${E?"bg-error-100":D?"bg-warning-100":"bg-primary-100"}`,children:t.jsx(Me,{className:`w-5 h-5 ${E?"text-error-600":D?"text-warning-600":"text-primary-600"}`})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Days Remaining"}),t.jsx("p",{className:`text-lg font-semibold ${E?"text-error-900":D?"text-warning-900":"text-gray-900"}`,children:w})]})]})}),t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-warning-100 rounded-lg flex items-center justify-center",children:t.jsx(_e,{className:"w-5 h-5 text-warning-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Usage"}),t.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[(a==null?void 0:a.utilizationPercentage)||0,"%"]})]})]})})]}),h&&t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subscription Details"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Current Plan"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Plan:"}),t.jsx("span",{className:"font-medium",children:h.plan.name})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Device Limit:"}),t.jsx("span",{className:"font-medium",children:h.plan.deviceLimit})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Status:"}),t.jsx("span",{className:`badge ${h.status==="ACTIVE"?"badge-success":"badge-warning"}`,children:h.status})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Expires:"}),t.jsx("span",{className:"font-medium",children:Ue(new Date(h.endDate),"MMM dd, yyyy")})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Usage"}),t.jsx("div",{className:"space-y-3",children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{className:"text-gray-600",children:"Devices Used"}),t.jsxs("span",{className:"font-medium",children:[a==null?void 0:a.devicesUsed," / ",a==null?void 0:a.deviceLimit]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${((a==null?void 0:a.utilizationPercentage)||0)>=100?"bg-error-600":((a==null?void 0:a.utilizationPercentage)||0)>=80?"bg-warning-600":"bg-success-600"}`,style:{width:`${Math.min((a==null?void 0:a.utilizationPercentage)||0,100)}%`}})})]})})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upgrade Your Plan"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r.map(u=>{const R=(h==null?void 0:h.plan.id)===u.id,T=h&&u.price<h.plan.price;return t.jsxs("div",{className:`border rounded-lg p-6 ${R?"border-primary-200 bg-primary-50":"border-gray-200 hover:border-primary-200"} transition-colors`,children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u.name}),t.jsxs("div",{className:"mt-2",children:[t.jsx("span",{className:"text-3xl font-bold text-gray-900",children:u.price===0?"Free":`$${u.price}`}),u.price>0&&t.jsxs("span",{className:"text-gray-600",children:["/",u.durationDays," days"]})]}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:u.description})]}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Devices:"}),t.jsx("span",{className:"font-medium",children:u.deviceLimit})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Duration:"}),t.jsxs("span",{className:"font-medium",children:[u.durationDays," days"]})]})]}),t.jsx("div",{className:"mt-6 space-y-2",children:R?t.jsx("div",{className:"btn-primary w-full opacity-50 cursor-not-allowed",children:"Current Plan"}):T?t.jsx("div",{className:"btn-secondary w-full opacity-50 cursor-not-allowed",children:"Downgrade Not Available"}):t.jsx(t.Fragment,{children:u.price>0?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>S(u.id,"stripe"),disabled:o===u.id,className:"btn-primary w-full",children:o===u.id?t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("div",{className:"loading-spinner w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),t.jsx("span",{children:"Processing..."})]}):"Pay with Card (Stripe)"}),t.jsx("button",{onClick:()=>S(u.id,"telebirr"),disabled:o===u.id,className:"btn-secondary w-full",children:"Pay with Telebirr"})]}):t.jsx("button",{onClick:()=>S(u.id),disabled:o===u.id,className:"btn-primary w-full",children:"Downgrade"})})})]},u.id)})})]})]}),x&&t.jsx(kt,{plan:x,isOpen:p,onClose:()=>{f(!1),g(null)}})]})}export{At as default};
//# sourceMappingURL=Dashboard-VylRGr2Z.js.map
