{"version":3,"file":"AdminPayments-WOe2I6If.js","sources":["../../src/pages/admin/AdminPayments.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport toast from 'react-hot-toast';\nimport { DollarSign, Calendar, CheckCircle, XCircle } from 'lucide-react';\n\ninterface Payment {\n  id: string;\n  amount: number;\n  status: string;\n  method: string;\n  createdAt: string;\n  user: {\n    id: string;\n    name: string;\n    email: string;\n  };\n  subscription?: {\n    plan: string;\n  };\n}\n\nexport default function AdminPayments() {\n  const [payments, setPayments] = useState<Payment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState('ALL');\n  const [dateRange, setDateRange] = useState('7');\n\n  useEffect(() => {\n    fetchPayments();\n  }, [filter, dateRange]);\n\n  const fetchPayments = async () => {\n    try {\n      setLoading(true);\n      const response = await axios.get('/admin/payments', {\n        params: { \n          status: filter !== 'ALL' ? filter : undefined,\n          days: dateRange \n        }\n      });\n      \n      setPayments(response.data.payments);\n    } catch (error) {\n      console.error('Error fetching payments:', error);\n      toast.error('Failed to load payments');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'COMPLETED':\n        return 'bg-green-100 text-green-800';\n      case 'FAILED':\n        return 'bg-red-100 text-red-800';\n      case 'PENDING':\n        return 'bg-yellow-100 text-yellow-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'ETB'\n    }).format(amount);\n  };\n\n  const totalRevenue = payments\n    .filter(p => p.status === 'COMPLETED')\n    .reduce((sum, p) => sum + p.amount, 0);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"loading-spinner w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Payment Management</h1>\n          <p className=\"text-gray-600\">Monitor transactions and revenue</p>\n        </div>\n      </div>\n\n      {/* Revenue Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <div className=\"card\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center\">\n              <DollarSign className=\"w-5 h-5 text-green-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Total Revenue</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{(totalRevenue)}</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <CheckCircle className=\"w-5 h-5 text-blue-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Successful</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {payments.filter(p => p.status === 'COMPLETED').length}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center\">\n              <XCircle className=\"w-5 h-5 text-red-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Failed</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {payments.filter(p => p.status === 'FAILED').length}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center\">\n              <Calendar className=\"w-5 h-5 text-yellow-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Pending</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {payments.filter(p => p.status === 'PENDING').length}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"card\">\n        <div className=\"flex flex-wrap items-center gap-4\">\n          <div className=\"flex space-x-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Status:</label>\n            {['ALL', 'COMPLETED', 'FAILED', 'PENDING'].map((status) => (\n              <button\n                key={status}\n                onClick={() => setFilter(status)}\n                className={`px-3 py-1 rounded-lg text-sm font-medium ${\n                  filter === status\n                    ? 'bg-primary-100 text-primary-700'\n                    : 'text-gray-600 hover:bg-gray-50'\n                }`}\n              >\n                {status}\n              </button>\n            ))}\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Period:</label>\n            <select\n              value={dateRange}\n              onChange={(e) => setDateRange(e.target.value)}\n              className=\"px-3 py-1 border border-gray-300 rounded-lg text-sm\"\n            >\n              <option value=\"7\">Last 7 days</option>\n              <option value=\"30\">Last 30 days</option>\n              <option value=\"90\">Last 90 days</option>\n              <option value=\"365\">Last year</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* Payments Table */}\n      <div className=\"card overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Transaction\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  User\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Amount\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Status\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Method\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Date\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {payments.map((payment) => (\n                <tr key={payment.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center\">\n                        <DollarSign className=\"w-5 h-5 text-primary-600\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <div className=\"text-sm font-medium text-gray-900\">{payment.id.slice(0, 8)}...</div>\n                        {payment.subscription && (\n                          <div className=\"text-sm text-gray-500\">{payment.subscription.plan}</div>\n                        )}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">{payment.user.name}</div>\n                      <div className=\"text-sm text-gray-500\">{payment.user.email}</div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {formatCurrency(payment.amount)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(payment.status)}`}>\n                      {payment.status}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {payment.method}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {new Date(payment.createdAt).toLocaleDateString()}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["AdminPayments","payments","setPayments","useState","loading","setLoading","filter","setFilter","dateRange","setDateRange","useEffect","fetchPayments","response","axios","error","toast","getStatusColor","status","formatCurrency","amount","totalRevenue","p","sum","jsx","jsxs","DollarSign","CheckCircle","XCircle","Calendar","e","payment"],"mappings":"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"}