{"version":3,"file":"AdminSettings-amQqVI-n.js","sources":["../../src/pages/admin/AdminSettings.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport toast from 'react-hot-toast';\nimport { Settings, Save, Database, Mail, Smartphone } from 'lucide-react';\n\ninterface SystemSettings {\n  traccarUrl: string;\n  traccarUser: string;\n  emailEnabled: boolean;\n  maintenanceMode: boolean;\n  maxDevicesPerUser: number;\n  cronEnabled: boolean;\n cronSchedule: string; \n cronCutoffHours: number; \n  subscriptionPlans: Array<{\n    name: string;\n    price: number;\n    devices: number;\n    features: string[];\n  }>;\n}\n\nexport default function AdminSettings() {\n  const [settings, setSettings] = useState<SystemSettings>({\n    traccarUrl: '',\n    traccarUser: '',\n    emailEnabled: false,\n    maintenanceMode: false,\n    cronEnabled: false,\n    cronSchedule: '',\n    cronCutoffHours: 1, \n    maxDevicesPerUser: 5,\n    subscriptionPlans: []\n  });\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    fetchSettings();\n  }, []);\n\n  const fetchSettings = async () => {\n    try {\n      setLoading(true);\n      const response = await axios.get('/admin/settings');\n      setSettings(response.data.settings);\n    } catch (error) {\n      console.error('Error fetching settings:', error);\n      toast.error('Failed to load settings');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const saveSettings = async () => {\n    try {\n      setSaving(true);\n      await axios.put('/admin/settings', { settings });\n      toast.success('Settings saved successfully');\n    } catch (error) {\n      console.error('Error saving settings:', error);\n      toast.error('Failed to save settings');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const testTraccarConnection = async () => {\n    try {\n      const response = await axios.post('/admin/test-traccar');\n      if (response.data.success) {\n        toast.success('Traccar connection successful');\n      } else {\n        toast.error('Traccar connection failed');\n      }\n    } catch (error) {\n      toast.error('Failed to test Traccar connection');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"loading-spinner w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">System Settings</h1>\n          <p className=\"text-gray-600\">Configure system-wide settings and preferences</p>\n        </div>\n        \n        <button\n          onClick={saveSettings}\n          disabled={saving}\n          className=\"btn-primary flex items-center space-x-2\"\n        >\n          <Save className=\"w-4 h-4\" />\n          <span>{saving ? 'Saving...' : 'Save Settings'}</span>\n        </button>\n      </div>\n\n      {/* Traccar Configuration */}\n      <div className=\"card\">\n        <div className=\"flex items-center space-x-3 mb-4\">\n          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center\">\n            <Database className=\"w-4 h-4 text-blue-600\" />\n          </div>\n          <h2 className=\"text-lg font-semibold text-gray-900\">Traccar Configuration</h2>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Traccar Server URL\n            </label>\n            <input\n              type=\"url\"\n              value={settings.traccarUrl}\n              onChange={(e) => setSettings({ ...settings, traccarUrl: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n              placeholder=\"https://demo4.traccar.org\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Traccar Username\n            </label>\n            <input\n              type=\"text\"\n              value={settings.traccarUser}\n              onChange={(e) => setSettings({ ...settings, traccarUser: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n              placeholder=\"admin\"\n            />\n          </div>\n        </div>\n\n        <div className=\"mt-4\">\n          <button\n            onClick={testTraccarConnection}\n            className=\"btn-secondary\"\n          >\n            Test Connection\n          </button>\n        </div>\n      </div>\n\n      {/* Device Settings */}\n      <div className=\"card\">\n        <div className=\"flex items-center space-x-3 mb-4\">\n          <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\">\n            <Smartphone className=\"w-4 h-4 text-green-600\" />\n          </div>\n          <h2 className=\"text-lg font-semibold text-gray-900\">Device Settings</h2>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Max Devices per User\n            </label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              max=\"100\"\n              value={settings.maxDevicesPerUser}\n              onChange={(e) => setSettings({ ...settings, maxDevicesPerUser: parseInt(e.target.value) })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Email Settings */}\n      <div className=\"card\">\n        <div className=\"flex items-center space-x-3 mb-4\">\n          <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\">\n            <Mail className=\"w-4 h-4 text-purple-600\" />\n          </div>\n          <h2 className=\"text-lg font-semibold text-gray-900\">Email Settings</h2>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center space-x-3\">\n            <input\n              type=\"checkbox\"\n              id=\"emailEnabled\"\n              checked={settings.emailEnabled}\n              onChange={(e) => setSettings({ ...settings, emailEnabled: e.target.checked })}\n              className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\n            />\n            <label htmlFor=\"emailEnabled\" className=\"text-sm font-medium text-gray-700\">\n              Enable email notifications\n            </label>\n          </div>\n        </div>\n      </div>\n{/* Cron Job Settings */}\n<div className=\"card\">\n  <div className=\"flex items-center space-x-3 mb-4\">\n    <div className=\"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center\">\n      <Database className=\"w-4 h-4 text-yellow-600\" />\n    </div>\n    <h2 className=\"text-lg font-semibold text-gray-900\">Cron Job Settings</h2>\n  </div>\n\n  <div className=\"space-y-4\">\n    <div className=\"flex items-center space-x-3\">\n      <input\n        type=\"checkbox\"\n        id=\"cronEnabled\"\n        checked={Boolean((settings as any).cronEnabled )|| false}\n        onChange={(e) =>\n          setSettings({ ...settings, cronEnabled: e.target.checked })\n        }\n        className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\n      />\n      <label htmlFor=\"cronEnabled\" className=\"text-sm font-medium text-gray-700\">\n        Enable automated cron jobs\n      </label>\n    </div>\n\n    <div>\n      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n        Schedule (Cron Expression)\n      </label>\n      <input\n        type=\"text\"\n        value={(settings as any).cronSchedule || '0 * * * *'}\n        onChange={(e) =>\n          setSettings({ ...settings, cronSchedule: e.target.value })\n        }\n        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n        placeholder=\"0 * * * *\"\n      />\n      <p className=\"text-xs text-gray-500 mt-1\">\n        Example: “0 * * * *” = every hour, “*/10 * * * *” = every 10 minutes\n      </p>\n    </div>\n\n    <div>\n      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n        Expire PENDING Payments After (hours)\n      </label>\n      <input\n        type=\"number\"\n        min=\"1\"\n        max=\"168\"\n        value={(settings as any).cronCutoffHours || 24}\n        onChange={(e) =>\n          setSettings({\n            ...settings,\n            cronCutoffHours: parseInt(e.target.value),\n          })\n        }\n        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n      />\n    </div>\n  </div>\n</div>\n      {/* System Settings */}\n      <div className=\"card\">\n        <div className=\"flex items-center space-x-3 mb-4\">\n          <div className=\"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center\">\n            <Settings className=\"w-4 h-4 text-red-600\" />\n          </div>\n          <h2 className=\"text-lg font-semibold text-gray-900\">System Settings</h2>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center space-x-3\">\n            <input\n              type=\"checkbox\"\n              id=\"maintenanceMode\"\n              checked={settings.maintenanceMode}\n              onChange={(e) => setSettings({ ...settings, maintenanceMode: e.target.checked })}\n              className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\n            />\n            <label htmlFor=\"maintenanceMode\" className=\"text-sm font-medium text-gray-700\">\n              Enable maintenance mode\n            </label>\n            <span className=\"text-xs text-gray-500\">\n              (Prevents new user registrations and limits access)\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["AdminSettings","settings","setSettings","useState","loading","setLoading","saving","setSaving","useEffect","fetchSettings","response","axios","error","toast","saveSettings","testTraccarConnection","jsx","jsxs","Save","Database","e","Smartphone","Mail","Settings"],"mappings":"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"}