import{r as d,b as L,z as u,j as e,e as R,S as O,k as U}from"./index-Dza2ow_d.js";import{D as P}from"./download-CYelR1NA.js";import{D as T}from"./dollar-sign-FcAv3wVh.js";import{C as j}from"./check-circle-DrxfHzqS.js";import{T as F}from"./trending-up-QOAHLxeJ.js";import{C as y,L as H}from"./list-filter-Dzl4lTSQ.js";import{C as N}from"./clock-Bia-aWg3.js";import{S as $}from"./search-biM9ioye.js";import{f as x}from"./index-CipiYhTN.js";function Q(){const[g,S]=d.useState([]),[n,E]=d.useState(null),[a,m]=d.useState({page:1,limit:20,total:0,pages:0}),[k,f]=d.useState(!0),[c,o]=d.useState({status:"ALL",dateRange:"30",search:"",from:"",to:""}),[r,v]=d.useState(null);d.useEffect(()=>{w()},[a.page,c]);const w=async()=>{try{f(!0);const s={page:a.page,limit:a.limit};c.status!=="ALL"&&(s.status=c.status),c.search&&(s.search=c.search),c.from&&(s.from=c.from),c.to&&(s.to=c.to);const t=await L.get("/admin/orders",{params:s});S(t.data.orders),E(t.data.summary),m(t.data.pagination)}catch(s){console.error("Error fetching orders:",s),u.error("Failed to load orders")}finally{f(!1)}},b=s=>{switch(s){case"COMPLETED":return"bg-success-100 text-success-800";case"FAILED":return"bg-error-100 text-error-800";case"PENDING":return"bg-warning-100 text-warning-800";case"CANCELLED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},C=s=>{switch(s){case"COMPLETED":return e.jsx(j,{className:"w-4 h-4"});case"FAILED":return e.jsx(y,{className:"w-4 h-4"});case"PENDING":return e.jsx(N,{className:"w-4 h-4"});case"CANCELLED":return e.jsx(y,{className:"w-4 h-4"});default:return e.jsx(N,{className:"w-4 h-4"})}},p=(s,t="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(s),M=()=>{const s=[["Order ID","User","Email","Amount","Status","Payment Method","Date"].join(","),...g.map(l=>[l.orderId,l.user.name,l.user.email,l.amount,l.status,l.paymentMethod||"N/A",x(new Date(l.createdAt),"yyyy-MM-dd HH:mm:ss")].join(","))].join(`
`),t=new Blob([s],{type:"text/csv"}),h=URL.createObjectURL(t),i=document.createElement("a");i.href=h,i.download=`admin_orders_${x(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(h),u.success("Orders exported successfully")},A=async s=>{try{const t=await L.get(`/admin/orders/${s}/invoice`,{responseType:"blob"}),h=new Blob([t.data],{type:"application/pdf"}),i=URL.createObjectURL(h),l=document.createElement("a");l.href=i,l.download=`invoice_${s}.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),u.success("Invoice downloaded successfully")}catch(t){console.error("Error downloading invoice:",t),u.error("Failed to download invoice")}},D=s=>{m(t=>({...t,page:s}))},I=s=>{s.preventDefault(),m(t=>({...t,page:1})),w()};return k&&g.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Reports"}),e.jsx("p",{className:"text-gray-600",children:"Monitor all system orders and transactions"})]}),e.jsxs("button",{onClick:M,className:"btn-primary flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Orders"})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.totalOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-success-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p(n.totalRevenue)})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-success-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Success Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[n.successRate,"%"]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-warning-100 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-warning-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Order Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p(n.averageOrderValue)})]})]})})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-success-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.completedOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-error-100 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-error-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Failed Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.failedOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-warning-100 rounded-lg flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-warning-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.pendingOrders})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("form",{onSubmit:I,className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative min-w-64",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by order ID, user name, or email...",value:c.search,onChange:s=>o(t=>({...t,search:s.target.value})),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Search"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"})]}),e.jsx("div",{className:"flex space-x-2",children:["ALL","COMPLETED","FAILED","PENDING","CANCELLED"].map(s=>e.jsx("button",{onClick:()=>{o(t=>({...t,status:s})),m(t=>({...t,page:1}))},className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${c.status===s?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-50"}`,children:s},s))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date Range:"}),e.jsx("input",{type:"date",value:c.from,onChange:s=>o(t=>({...t,from:s.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:c.to,onChange:s=>o(t=>({...t,to:s.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded"})]})]})]}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.orderId}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{onClick:()=>v(s),className:"px-3 py-1 bg-blue-500 text-white rounded text-xs",children:"View Details"})})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(U,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.user.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.user.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:p(s.amount,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 text-xs font-semibold rounded-full ${b(s.status)}`,children:[C(s.status),e.jsx("span",{children:s.status})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((t=s.plan)==null?void 0:t.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.paymentMethod||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(new Date(s.createdAt),"MMM dd, yyyy HH:mm")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("button",{onClick:()=>A(s.orderId),className:"text-green-600 hover:text-green-800 flex items-center space-x-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5 5-5M12 15V3"})}),e.jsx("span",{children:"Invoice"})]})})]},s.id)})})]})}),a.pages>1&&e.jsxs("div",{className:"px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(a.page-1)*a.limit+1," to ",Math.min(a.page*a.limit,a.total)," of ",a.total," orders"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D(a.page-1),disabled:a.page===1,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",a.page," of ",a.pages]}),e.jsx("button",{onClick:()=>D(a.page+1),disabled:a.page===a.pages,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Order Details"}),e.jsx("button",{onClick:()=>v(null),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:"Ã—"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Order ID:"}),e.jsx("p",{className:"font-medium",children:r.orderId.slice(0,8)})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Amount:"}),e.jsx("p",{className:"font-medium",children:p(r.amount,r.currency)})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Status:"}),e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 text-xs font-semibold rounded-full ${b(r.status)}`,children:[C(r.status),e.jsx("span",{children:r.status})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Payment Method:"}),e.jsx("p",{className:"font-medium",children:r.paymentMethod||"N/A"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Name:"}),e.jsx("p",{className:"font-medium",children:r.user.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Email:"}),e.jsx("p",{className:"font-medium",children:r.user.email})]})]})]}),r.telebirrTxId&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Telebirr Transaction ID:"}),e.jsx("p",{className:"font-medium font-mono text-sm",children:r.telebirrTxId})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Created:"}),e.jsx("p",{className:"font-medium",children:x(new Date(r.createdAt),"MMM dd, yyyy HH:mm")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Updated:"}),e.jsx("p",{className:"font-medium",children:x(new Date(r.updatedAt),"MMM dd, yyyy HH:mm")})]})]})]})]})})]})}export{Q as default};
//# sourceMappingURL=AdminOrderReports-D6rYhqU-.js.map
