import{c as I,r as i,b as f,z as x,j as e,e as M,S as b}from"./index-Dza2ow_d.js";import{D as P}from"./download-CYelR1NA.js";import{D as R}from"./dollar-sign-FcAv3wVh.js";import{C as v}from"./check-circle-DrxfHzqS.js";import{C as p,L as F}from"./list-filter-Dzl4lTSQ.js";import{C as T}from"./calendar-CDwTpDyp.js";import{f as h}from"./index-CipiYhTN.js";import{C as w}from"./clock-Bia-aWg3.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=I("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);function J(){const[o,C]=i.useState([]),[l,L]=i.useState(null),[a,u]=i.useState({page:1,limit:20,total:0,pages:0}),[E,y]=i.useState(!0),[c,m]=i.useState({status:"ALL",from:"",to:""});i.useEffect(()=>{D()},[a.page,c]);const D=async()=>{try{y(!0);const s={page:a.page,limit:a.limit};c.status!=="ALL"&&(s.status=c.status),c.from&&(s.from=c.from),c.to&&(s.to=c.to);const t=await f.get("/user/orders",{params:s});C(t.data.orders),L(t.data.summary),u(t.data.pagination)}catch(s){console.error("Error fetching orders:",s),x.error("Failed to load orders")}finally{y(!1)}},k=s=>{switch(s){case"COMPLETED":return"bg-success-100 text-success-800";case"FAILED":return"bg-error-100 text-error-800";case"PENDING":return"bg-warning-100 text-warning-800";case"CANCELLED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},O=s=>{switch(s){case"COMPLETED":return e.jsx(v,{className:"w-4 h-4"});case"FAILED":return e.jsx(p,{className:"w-4 h-4"});case"PENDING":return e.jsx(w,{className:"w-4 h-4"});case"CANCELLED":return e.jsx(p,{className:"w-4 h-4"});default:return e.jsx(w,{className:"w-4 h-4"})}},g=(s,t="ETB")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(s),S=()=>{const s=[["Order ID","Invoice Number","Subscription Plan","Amount","Status","Payment Method","Date"].join(","),...o.map(r=>{var N;return[r.orderId,r.invoiceNumber||"N/A",((N=r.plan)==null?void 0:N.name)||"N/A",r.amount,r.status,r.paymentMethod||"N/A",h(new Date(r.createdAt),"yyyy-MM-dd HH:mm:ss")].join(",")})].join(`
`),t=new Blob([s],{type:"text/csv"}),d=URL.createObjectURL(t),n=document.createElement("a");n.href=d,n.download=`orders_${h(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(d),x.success("Orders exported successfully")},A=async s=>{try{const t=await f.get(`/user/orders/${s}/invoice`,{responseType:"blob"}),d=new Blob([t.data],{type:"application/pdf"}),n=URL.createObjectURL(d),r=document.createElement("a");r.href=n,r.download=`invoice_${s}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n),x.success("Invoice downloaded successfully")}catch(t){console.error("Error downloading invoice:",t),x.error("Failed to download invoice")}},j=s=>{u(t=>({...t,page:s}))};return E&&o.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(M,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Reports"}),e.jsx("p",{className:"text-gray-600",children:"View and manage your order history"})]}),e.jsxs("button",{onClick:S,className:"btn-primary flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Orders"})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(b,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.totalOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-success-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Spent"}),e.jsx("p",{className:"text-2 font-bold text-gray-900",children:g(l.totalAmount)})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(v,{className:"w-5 h-5 text-success-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.completedOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-error-100 rounded-lg flex items-center justify-center",children:e.jsx(p,{className:"w-5 h-5 text-error-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.failedOrders})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-warning-100 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-warning-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Success Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.successRate,"%"]})]})]})})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),["ALL","COMPLETED","FAILED","PENDING","CANCELLED"].map(s=>e.jsx("button",{onClick:()=>m(t=>({...t,status:s})),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${c.status===s?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-50"}`,children:s},s))]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date Range:"}),e.jsx("input",{type:"date",value:c.from,onChange:s=>m(t=>({...t,from:s.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:c.to,onChange:s=>m(t=>({...t,to:s.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded"})]})]})}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription Plan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.orderId}),s.invoiceNumber&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Invoice: ",s.invoiceNumber]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:((t=s.plan)==null?void 0:t.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g(s.amount,s.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 text-xs font-semibold rounded-full ${k(s.status)}`,children:[O(s.status),e.jsx("span",{children:s.status})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.paymentMethod||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h(new Date(s.createdAt),"MMM dd, yyyy HH:mm")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("button",{onClick:()=>s.invoiceNumber&&A(s.orderId),disabled:!s.invoiceNumber||s.status!=="COMPLETED",className:`flex items-center space-x-1 ${s.invoiceNumber?"text-primary-600 hover:text-primary-900":"text-gray-400 cursor-not-allowed"}`,children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:s.invoiceNumber?"Download Invoice":"Invoice Not Ready"})]})})]},s.id)})})]})}),a.pages>1&&e.jsxs("div",{className:"px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(a.page-1)*a.limit+1," to ",Math.min(a.page*a.limit,a.total)," of ",a.total," orders"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>j(a.page-1),disabled:a.page===1,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",a.page," of ",a.pages]}),e.jsx("button",{onClick:()=>j(a.page+1),disabled:a.page===a.pages,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})}export{J as default};
//# sourceMappingURL=OrderReports-DEM9asI8.js.map
